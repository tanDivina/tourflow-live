FROM node:20-slim

WORKDIR /app

# Install dependencies
COPY package*.json ./
RUN npm ci --only=production

# Copy source code
COPY . .

# Install a process manager to run both scripts
RUN npm install -g concurrently

# Set Environment defaults
# Start both the Backend Server and the AI Processor
CMD ["concurrently", "node server.js", "node ai_processor.js"]
